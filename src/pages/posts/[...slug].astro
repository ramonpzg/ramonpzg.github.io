---
import { getCollection } from 'astro:content';
import PostLayout from '../../layouts/PostLayout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => {
    // Extract just the filename/folder from the full path
    // e.g., "src/content/posts/2024-05-16-rag-intro" -> "2024-05-16-rag-intro"
    const slug = post.id.split('/').pop()?.replace(/\.(mdx?|md)$/, '') || post.id;
    return {
      params: { slug },
      props: { post },
    };
  });
}

const { post } = Astro.props;
---

<PostLayout post={post} type="post" />
